MODEL:
  NAME: 'transformer'
  TRANSFORMER_TYPE: 'deit_base_patch16_224_TransReID'
  STRIDE_SIZE: [12, 12]
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: './pretrained/deit_base_distilled_patch16_224-df68dfff.pth'

  # Supervised training mode
  TRAINING_MODE: 'supervised'

  # CLIP module disabled (pure supervised baseline)
  USE_CLIP: False

# -----------------------------------------------------------------------------
# LOSS CONFIGURATION
# -----------------------------------------------------------------------------
LOSS:
  # ---------------- Triplet (baseline metric learning) ----------------
  TRIPLET:
    FEAT_SRC: 'pre_bn'               # Use pre-BN (backbone) features

  # ---------------- TripletX (disabled) ----------------
  TRIPLETX:
    ENABLE: False                    # TripletX disabled for this experiment

  # ---------------- SupCon (Supervised Contrastive Learning) ----------------
  SUPCON:
    ENABLE: True                     # Enable SupCon
    W: 0.30                          # Static SupCon weight
    T: 0.07                          # Temperature parameter
    CAM_AWARE: True                  # Camera-aware positive sampling
    POS_RULE: "class"                # Positive pairs follow class-based rule
    FEAT_SRC: 'pre_bn'               # Use pre-BN features for consistency

  # ---------------- Phased loss (disabled) ----------------
  PHASED:
    ENABLE: False                    # No epoch-based switching

  # ---------------- Brightness weighting (disabled) ----------------
  BRIGHTNESS:
    ENABLE: False                    # No brightness-aware training

# -----------------------------------------------------------------------------
# INPUT / DATA LOADING
# -----------------------------------------------------------------------------
INPUT:
  SIZE_TRAIN: [256, 256]             # Training image size
  SIZE_TEST: [256, 256]              # Testing image size

DATALOADER:
  SAMPLER: 'softmax_triplet'         # PÃ—K sampling for triplet-based learning
  NUM_INSTANCE: 8                    # K=8 (8 images per identity)
  NUM_WORKERS: 8                     # Number of data loading threads

# -----------------------------------------------------------------------------
# SOLVER / OPTIMIZATION
# -----------------------------------------------------------------------------
SOLVER:
  OPTIMIZER_NAME: "SGD"              # Use stochastic gradient descent
  BASE_LR: 0.01                      # Base learning rate
  WEIGHT_DECAY: 1e-4                 # Weight decay
  MOMENTUM: 0.9                      # Momentum factor
  MAX_EPOCHS: 120                    # Total number of training epochs
  STEPS: (40, 70)                    # LR decay milestones
  WARMUP_EPOCHS: 5                   # Warmup stage
  IMS_PER_BATCH: 64                  # Batch size

# -----------------------------------------------------------------------------
# TEST / EVALUATION
# -----------------------------------------------------------------------------
TEST:
  IMS_PER_BATCH: 256                 # Batch size during evaluation
  FEAT_NORM: 'yes'                   # Normalize features before testing
  EVAL: True                         # Enable evaluation

# -----------------------------------------------------------------------------
# DATASET CONFIGURATION
# -----------------------------------------------------------------------------
DATASETS:
  NAMES: 'veri'                      # Dataset name (VeRi-776)
  ROOT_DIR: '../datasets'            # Dataset path

# -----------------------------------------------------------------------------
# OUTPUT CONFIGURATION
# -----------------------------------------------------------------------------
OUTPUT_DIR: './logs/deit_transreid_stride_ce_triplet_pk8_prebn_supcon_prebn'
